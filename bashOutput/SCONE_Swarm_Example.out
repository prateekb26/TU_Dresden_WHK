

To simplify pushing images to the local registry, the scone CLI includes a **scone service pull** command to pull
an image from docker hub and then to push this image to the local registry. For example, to pull image
*sconecuratedimages/sconetainer:noshielding* and store it as *localhost:5000/sconetainer:noshielding*,
just execute:


### SGX Support

Services are automatically restarted. In case, there is a persistent failure in some service *ha*, we would see
repeated restarts like: 


Reasons for such failures might be that that the containers might not have access to the sgx device. 

There are multiple reasons why the driver might not be accessible inside of a container: Did you indeed install the patched docker version? Did you indeed label the nodes correctly? To automatically diagnoses and in some cases, to perform some automatic corrections, just execute **scone swarm check**:


To get a summary view of a swarm after you performed a check, just executed:


## Starting a Service

After pulling an image into the local registry (see above), we can
start a service in the swarm via **scone service create**.
Docker swarm will start the image and it also takes care of failures by restarting failed services.

For the next steps, make sure that all nodes have access to image *sconecuratedimages/sconetainer:noshielding* and pull this image via:


We start a nginx service including a version of the scontain.com website. We start two replicas running inside separate enclaves - most likely on two different nodes:


In case the service starts up correctly, you will see a status like this:


If, for example, an image is not available on all nodes, you might see the following status:


## Stopping the service

Stop the service via:



## Updating the image of a service

Say, there is a new version of the sconetainer image available. We can update this image in our local registry
as follows:


We can now update the service as follows:


## Draining a node

To be able to drain all containers from a node, we need to figure out the node's id. We can do this manually by executing the following command on the leader node:


You can now take node *alice* out of service by executing:


To put the node back in service by executing:



&copy; [scontain.com](http://www.scontain.com), November 2017. [Questions or Suggestions?](mailto:info@scontain.com)